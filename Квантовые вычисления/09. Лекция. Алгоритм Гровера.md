## Алгоритм Гровера
Алгоритм для быстрого поиска по базе данных

У нас есть таблица, в этой таблице есть какие-либо записи. Записи в таблице не отсортированы 

Если $N-$ количество записей, то:
- Сложность классического способа: $O(N)$
- Сложность квантового способа: $O(\sqrt{N})\Rightarrow$ квадратичное ускорение

Пусть **id** - некоторый уникальный идентификатор в таблице, который необходимо будет найти

Кодирование идентификаторов будет происходить с помощью кубитов
$$N=2^{n},\text{ где }n-\text{количество кубитов}$$

Если у нас 12 кубитов, то мы может закодировать $2^{12}=4096$ чисел (от 0 до 4095)

> Алгоритм был разработан Ловом Кумаром Гровером в 1996 году

Идея состоит в том, что Оракул находит нужную запись и помечает ее идентификатор, умножая его на -1

Алгоритм Гровера состоит из определенных частей и у него есть части, которые нужно запускать определенное количество раз (алгоритм является итерационным). Для того чтобы знать, какое количество итераций запустить, нужно предварительно посчитать количество данных операций (еще до запуска алгоритма). Для этого нужно заранее знать сколько записей в таблице и сколько запись мы ищем 

###### Пример
Начальные условия:
$$
n=2, N=2^{2}=4
$$
$$
\text{Записи}:n=00, 01,10,11
$$

Предположим, что мы ищем запись 11

Вместо реального Оракула, который находит определенную запись по условию, создадим Оракул, который заданный id будет отмечать минусом

Проблема в том, что при измерении минус пропадает, так что нужно будет обнаружить полученный минус, для этого и нужен алгоритм Гровера

###### Квантовая схема
Используем 2 кубита и один вспомогательный (для поиска минуса)
![](../_%20Assets/Pasted%20image%2020231225035103.png)

> Книжный формат записи (верхний кубит на схеме слева)

> Алгоритм Гровера повторяет повторяет определенную часть схемы (такие повторы называются итерациями). Итерации состоят из двух частей. Первая часть - фрагмент с первого по второй момент времени, вторая часть - моменты времени со второго по третий

###### Определим моменты времени

1. Момент времени непосредственно перед первым оператором CCX:
$$
\ket{\psi}=\frac{1}{2\sqrt{2}}(\ket{0}+\ket{1})(\ket{0}+\ket{1})(\ket{0}-\ket{1})=
$$
$$
=\frac{1}{2\sqrt{2}}(\ket{00}+\ket{01}+\ket{10}+\ket{11})(\ket{0}-\ket{1})=
$$
$$
=\frac{1}{2\sqrt{2}}(\ket{00}(\ket{0}-\ket{1})+\ket{01}(\ket{0}-\ket{1})+\ket{10(\ket{0}-\ket{1})}+\ket{11}(\ket{0}-\ket{1}))
$$
2. Момент времени непосредственно после первого оператора CCNOT (вентиль Тоффоли). 
> Данная часть (между моментом 1 и 2) была выбрана таким образом, чтобы срабатывать на искомый id, равный 11
$$
\ket{\psi}=\frac{1}{2\sqrt{2}}(\ket{00}(\ket{0}-\ket{1})+\ket{01}(\ket{0}-\ket{1})+\ket{10(\ket{0}-\ket{1})}+\ket{11}(\ket{1}-\ket{0}))=
$$
$$
=\frac{1}{2\sqrt{2}}(\ket{00}(\ket{0}-\ket{1})+\ket{01}(\ket{0}-\ket{1})+\ket{10(\ket{0}-\ket{1})}-\ket{11}(\ket{0}-\ket{1}))=
$$
$$
=\frac{1}{2\sqrt{2}}(\ket{0}+\ket{01}+\ket{10}-\ket{11})(\ket{0}-\ket{1})
$$
Роль Оракула возложена на вентиль Тоффоли. Таким образом, мы отметили минусом искомое состояние
>Часть схемы со 2 по 3 пункт является второй частью итерации (первой была работа вентиля Тоффоли). Она может **усилить амплитуду при искомом идентификаторе**

3. Момент времени непосредственно перед измерениями 
---

###### Итерации

Рассмотрим итерации более подробно. Представим состояние схемы в виде единичной окружности, где вертикальная ось показывает амплитуду искомого состояние, горизонтальная ось показывает амплитуду состояний суперпозиции всех состояний, кроме искомого. Также будет некоторый вектор, который будет соответствовать состоянию двухкубитной системы, когда все четыре состояния имеют одинаковую амплитуду _(соответствует временной точке один)_). Также мы не будем на окружности изображать состояние вспомогательного кубита. На такой окружности удобно изображать действительные амплитуды, но нельзя отобразить комплексные амплитуды 
>Вектор $c-$состояние верхних кубитов **в момент один** (равная суперпозиция), когда искомый вектор не отмечен минусом
>Вектор $a-$ искомое состояние
>Вектор $b-$ суперпозиция всех состояний, кроме искомого
![400](../_%20Assets/Pasted%20image%2020231225120524.png)
$$
\ket{c}=\frac{1}{2}(\ket{00}+\ket{01}+\ket{10}+\ket{11})
$$
Найдем координаты вектора $c$. Представим вектор как комбинацию векторов $a$ и $b$. Также отметим угол $\theta$ (угол между вектором $c$ и $b$)
$$
\ket{c}=cos{\theta}\ket{b}+sin{\theta}\ket{a}=
$$
$$
=cos{\theta}\frac{1}{\sqrt{3}}(\ket{00}+\ket{01}+\ket{10})+sin{\theta}\ket{11}=
$$
Отсюда найдем угол $\theta$:
$$
cos{\theta}=\frac{(\frac{1}{2})}{(\frac{1}{\sqrt{3}})}=\frac{\sqrt{3}}{2};\space
sin{\theta}=\frac{1}{2}
$$
$$
\Rightarrow\theta=\frac{\pi}{6}
$$
Координаты вектора $c$ (в момент времени один):
$$
c=(\frac{\sqrt{3}}{2}, \frac{1}{2})
$$
Далее введем новый вектор $c_{1b}$, где 1 - номер итерации, $b$ - отражение относительно горизонтального вектора $b$ на угол $\theta$:
$$
c_{1b}=(\frac{\sqrt{3}}{2}, -\frac{1}{2})
$$
![400](../_%20Assets/Pasted%20image%2020231225122636.png)
$$
\angle(c, c_{1b})=2\theta
$$
Введем унитарный оператор $U_b$, который помечает минусом искомое состояние:
$$
U_{b}=I-2\ket{a}\bra{a}
$$
$$
\ket{a}\bra{a}=\left(
\begin{array}{c}
0 \\
0 \\
0 \\
1
\end{array}
\right)\cdot(0001)=\left(
\begin{matrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 
\end{matrix}
\right)
$$
$$
U_{b}=\left(
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 
\end{matrix}
\right)-2\left(
\begin{matrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 
\end{matrix}
\right)=\left(
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & -1 
\end{matrix}
\right)
$$
Применим оператор $U_{b}$ к состоянию к временно точке один **(получим момент времени 2)**:
$$
c_{1b}=U_{b}c=\left(
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & -1 
\end{matrix}
\right)\frac{1}{2}\left(
\begin{array}{c}
1 \\
1 \\
1 \\
1
\end{array}
\right)=\frac{1}{2}\left(
\begin{array}{c}
1 \\
1 \\
1 \\
-1
\end{array}
\right)=
$$
$$
=\frac{1}{2}(\ket{00}+\ket{01}+\ket{10}-\ket{11})
$$

Вторая часть итерации будет отражать вектор $c_{1b}$ относительно вектора $c$ вверх:
![400](../_%20Assets/Pasted%20image%2020231225124023.png)

>Таким образом, каждая итерация двигает вектор $c$ в сторону искомого состояние $a$. Двухкубитной системе хватит одной итерации

>Зная, что на каждой итерации добавляется $2\theta$ в сторону искомого вектора $a$, можем посчитать, сколько потребуется итераций

Рассмотрим более подробно получение вектора $c_{1c}$. Введем оператор $U_{c}$, который совершает поворот относительно вектора $c$
$$
U_{c}=2\ket{c}\bra{c}-I
$$
$$
\ket{c}\bra{c}=\frac{1}{2}\left(
\begin{array}{c}
1 \\
1 \\
1 \\
1
\end{array}
\right)\cdot\frac{1}{2}(1111)
$$
$$
U_{c}=\frac{1}{2}\left(
\begin{matrix}
-1 & 1 & 1 & 1 \\
1 & -1 & 1 & 1 \\
1 & 1 & -1 & 1 \\
1 & 1 & 1 & -1 
\end{matrix}
\right)
$$
$$
U_{c}\ket{c_{1b}}=c_{1c}
$$
Мы получили** итоговое состояние итерации**

Выведем формулу для величины угла между итоговым вектором и вектором $b_{1}$ по $n$-ого количества итераций:
$$
\theta+2\theta\cdot n=\theta(1+2n)
$$
Мы получили формулу нахождения итогового угла после $n$ операций. Если число итераций подобрано правильно, то мы получим итоговый угол, равный либо $90\degree$, либо близкий к $90\degree$

Формула для нахождения количества итераций от угла:
$$
n=\frac{\frac{\pi}{2}-\theta}{2\theta}
$$

Мы рассмотрели случай, при котором искомая запись является единственный. Если же таких записей несколько, то в качестве вектора $a$ нужно взять суперпозицию базисных векторов состояний, которая соответствует искомым записям

При большом $N$ (большом количестве записей), угол $\theta$ становится малым. Из этого знания выводится формула нахождения нужного количества операций для нескольких искомых записей $k$:
$$
n=\frac{4}{\pi}\sqrt{\frac{N}k{}}
$$

